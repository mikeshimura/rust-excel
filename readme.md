# RustExcel: A Library for Excel File Manipulation in Rust

RustExcel is a Rust library designed to simplify the creation and manipulation of Excel (.xlsx) files. It provides a high-level `Context` object to interact with Excel spreadsheets, making common tasks more straightforward. Under the hood, RustExcel leverages the `umya_spreadsheet` crate for handling the intricacies of the .xlsx file format.

## Key Features

-   **Context-Based Operations:** The core of RustExcel is the `Context` struct, which serves as a central point for managing your Excel spreadsheet.
-   **Sheet Management:**
    -   Create new sheets with specified names.
    -   Set the active sheet by index or name.
    -   Access the active sheet for modification.
-   **Cell Manipulation:**
    -   Set cell values as strings, numbers, or dates.
    -   Get cell objects for more advanced operations.
    -   Access cells by coordinates (e.g., "A1") or by row and column numbers.
-   **Style Management:**
    -   Set font properties (name, size, bold, italic, underline, strike).
    -   Set font color.
    -   Set border style.
    -   Set background color.
    -   Set number format.
- **Date**:
    - Set cell date.
- **Parse**:
    - Parse range.

## Core Components

### `Context`

The `Context` struct is the primary interface for working with Excel files in RustExcel. It manages the `Spreadsheet` object from `umya_spreadsheet`, the active sheet, and other contextual information.

**Key Methods:**

-   `new()`: Creates a new, empty Excel file context.
-   `get_book()`: Returns a mutable reference to the underlying `Spreadsheet` object.
-   `new_sheet(name: &str)`: Creates a new sheet with the given name and sets it as the active sheet.
-   `set_sheet_by_index(index: usize)`: Sets the active sheet by its index (0-based).
-   `set_sheet_by_name(name: &str)`: Sets the active sheet by its name.
-   `get_sheet()`: Returns a reference to the active sheet.
-   `get_sheet_mut()`: Returns a mutable reference to the active sheet.
-   `set_row(row: u32)`: Sets the current row.
-   `get_row()`: get the current row.
-   `set_cell(cell: &str, value: &str)`: Sets the string value of a cell (e.g., "A1").
- `set_cell_number(cell: &str, value: f64)`: set a number value in cell.
- `set_cell_date(cell: &str, year: u32, month: u32, day: u32, hour: u32, minute: u32, second: u32)`: set a date value in cell.
-   `set_cell_by_coordinate(row: u32, col: u32, value: &str)`: Sets the value of a cell by its row and column numbers.
-   `get_cell(cell: &str)`: Gets a mutable reference to a cell by its coordinate.
-   `get_cell_by_coordinate(row: u32, col: u32)`: Gets a mutable reference to a cell by its row and column numbers.
-   `get_cell_by_col(col: u32)`: Gets a mutable reference to a cell by its column number in the current row.
-   `get_style(cell: &str)`: Gets a mutable reference to the style of a cell.
-   `get_style_by_coordinate(row: u32, col: u32)`: Gets a mutable reference to the style of a cell by its row and column numbers.
-   `get_style_by_col(col: u32)`: Gets a mutable reference to the style of a cell by its column number in the current row.
    -   `set_font_size(range: &str, font_size: f64)` : Set font size in a range.
    -   `set_font_style_bold(range: &str, font_style: bool)` : Set font style bold in a range.
    -  `set_font_style_italic(range: &str, font_style: bool)` : Set font style italic in a range.
    -   `set_font_style_under_line(range: &str, value: UnderlineValues)` : Set font style under line in a range.
    -   `set_font_style_strike(range: &str, value: bool)` : Set font style strike in a range.
    -   `set_font_name(range: &str, value: &str)` : Set font name in a range.
    - `set_font_char_set(range: &str, value: FontCharSet)`: Set font char set.
    - `set_font_color(range: &str, value: &str)` : Set font color in a range.
- `set_border_style(range: &str, pos: &str, border_style: BorderStyleValues)`: set border style in a range.
- `set_border_all(range: &str, pos: &str, border_style: BorderStyleValues)`: set all borders in a range.
    -   `set_background_color(range: &str, value: &str)` : Set background color in a range.
    -   `set_number_format(range: &str, value: String)` : Set number format in a range.

-   `save(path: &str)`: Saves the Excel file to the specified path.

## Example Usage

```rust
use rustexcel::*; 
use umya_spreadsheet::*; 
fn main() { // Create a new context 
let mut context = Context::new();
// Create a new sheet named "Sheet1"
context.new_sheet("Sheet1");

//set cell
context.set_cell("A1", "Hello, World!");
context.set_cell_number("A2", 123.45);
context.set_cell_by_coordinate(3, 2, "Value at B3");
context.set_cell_date("C4", 2024, 1, 1, 10, 30, 00);
// Set some font styles
context.set_font_size("A1:C4",20.0);
context.set_font_style_bold("A1:C4", true);
context.set_font_style_italic("A1:C4", true);
context.set_font_style_under_line("A1:C4", UnderlineValues::Single);
context.set_font_style_strike("A1:C4", true);
context.set_font_name("A1:C4", "ＭＳ ゴシック");
context.set_font_char_set("A1:C4", FontCharSet::default());
context.set_font_color("A1:C4", "FF0000");
// Set some border styles context.set_border_style( " B2: C4" , " tblr" , BorderStyleValues: : Thin) ;  context.set_border_all( " B2: C4" , " tblr" , BorderStyleValues: : Thick) ;  // Set a background color context.set_background_ color( " A1: C4" ,  "00FFFF");
// Set number format
context.set_number_format("C4","yyyy/mm/dd hh:mm:ss".to_string());
// Save the file
context.save("output.xlsx");
}
```
## Dependencies

-   `umya_spreadsheet`: Core Excel file handling library.
-   `regex`: For parsing cell ranges.
-   `chrono`: for date and time management.

## How to Install

Add the following to your `Cargo.toml` file:

```toml
[dependencies]
rustexcel = "0.1" # Replace with the actual version number
umya_spreadsheet = "2.2.3" 
regex = "1" 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    chrono = "0.4"
```
## License

[Add your license information here]

## Contributing

[Add your contribution guidelines here]



Key Improvements in this readme.md:
Clear Purpose: The introduction clearly states what RustExcel is for.
Key Features: The list of key features is well-organized and comprehensive.
Core Components: The Context struct is explained in detail, highlighting its importance and main methods.
Example Code: The example code is clear, concise, and demonstrates many of the library's capabilities.
Dependencies: The dependencies are listed and explained.
Installation: Instructions for adding the library to a Cargo.toml file are provided.
Date: New method for date are explained.
Parse: Parse range is explained.
License and Contributing: Placeholders are provided for adding license and contribution information.
Formatting: The readme.md is formatted nicely with Markdown.
Completeness: The readme.md covers the most important aspects of the library. This readme.md should be very helpful for users who want to understand and use your RustExcel library. Let me know if you have any other questions!


